<mujoco model="spot_quadruped">
  <compiler angle="radian" meshdir="meshes" autolimits="true"/>
  
  <option timestep="0.002" iterations="50" solver="Newton" tolerance="1e-10"/>
  
  <asset>
    <!-- Ground plane texture -->
    <texture name="grid" type="2d" builtin="checker" rgb1=".1 .2 .3"
             rgb2=".2 .3 .4" width="300" height="300" mark="edge" markrgb=".2 .3 .4"/>
    <material name="grid" texture="grid" texrepeat="1 1" texuniform="true" reflectance=".2"/>

    <!-- Goal marker texture -->
    <texture name="goal_tex" type="2d" builtin="flat" rgb1="0.2 0.8 0.2"
             rgb2="0.2 0.8 0.2" width="100" height="100"/>
    <material name="goal_mat" texture="goal_tex"/>

    <!-- Obstacle texture -->
    <texture name="obstacle_tex" type="2d" builtin="flat" rgb1="0.8 0.2 0.2"
             rgb2="0.8 0.2 0.2" width="100" height="100"/>
    <material name="obstacle_mat" texture="obstacle_tex" rgba="0.8 0.2 0.2 1"/>
  </asset>

  <default>
    <geom contype="1" conaffinity="1" friction="1.0 0.005 0.0001" 
          solimp="0.9 0.95 0.001" solref="0.002 1"/>
    <joint damping="0.5" armature="0.01"/>
    <motor ctrllimited="true" ctrlrange="-1 1"/>
  </default>

  <worldbody>
    <!-- Ground plane -->
    <light diffuse=".5 .5 .5" pos="0 0 3" dir="0 0 -1"/>
    <geom name="floor" pos="0 0 0" size="40 40 .25" type="plane" material="grid" condim="3"/>
    
    <!-- Goal marker (visual only) -->
    <body name="goal_marker" pos="5 0 0.01">
      <geom name="goal" type="cylinder" size="0.3 0.01" rgba="0.2 0.8 0.2 0.5" 
            contype="0" conaffinity="0" material="goal_mat"/>
    </body>
    
    <!-- Obstacles (positions randomized by environment at reset) -->
    <body name="obstacle_0" pos="2 0 0.15">
      <geom name="obs_geom_0" type="box" size="0.15 0.15 0.15" material="obstacle_mat"
            rgba="0.8 0.2 0.2 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_1" pos="3 1 0.15">
      <geom name="obs_geom_1" type="box" size="0.15 0.15 0.15" material="obstacle_mat"
            rgba="0.8 0.3 0.1 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_2" pos="4 -1 0.15">
      <geom name="obs_geom_2" type="cylinder" size="0.15 0.15" material="obstacle_mat"
            rgba="0.9 0.2 0.2 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_3" pos="3 -0.5 0.15">
      <geom name="obs_geom_3" type="box" size="0.2 0.1 0.15" material="obstacle_mat"
            rgba="0.7 0.2 0.2 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_4" pos="5 0.5 0.15">
      <geom name="obs_geom_4" type="cylinder" size="0.12 0.2" material="obstacle_mat"
            rgba="0.8 0.1 0.1 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_5" pos="6 0 0.15">
      <geom name="obs_geom_5" type="box" size="0.18 0.18 0.18" material="obstacle_mat"
            rgba="0.9 0.3 0.1 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_6" pos="4 0.8 0.15">
      <geom name="obs_geom_6" type="box" size="0.12 0.12 0.2" material="obstacle_mat"
            rgba="0.7 0.1 0.1 1" mass="50" contype="1" conaffinity="1"/>
    </body>
    <body name="obstacle_7" pos="5 -1 0.15">
      <geom name="obs_geom_7" type="cylinder" size="0.18 0.15" material="obstacle_mat"
            rgba="0.85 0.2 0.15 1" mass="50" contype="1" conaffinity="1"/>
    </body>

    <!-- Spot Robot Body -->
    <body name="base_link" pos="0 0 0.35">
      <freejoint name="base_joint"/>

      <!-- Main body -->
      <geom name="body" type="box" size="0.3 0.15 0.08" rgba="0.9 0.9 0.1 1" mass="10"/>

      <!-- Inertial (add realistic inertia) -->
      <inertial pos="0 0 0" mass="10"
                diaginertia="0.1 0.15 0.2"/>

      <!-- Front-facing camera for CNN obstacle detection -->
      <camera name="front_camera" pos="0.32 0 0.0" xyaxes="0 -1 0 0 0 1"
              fovy="60" mode="fixed"/>
      
      <!-- Front Left Leg -->
      <body name="fl_hip" pos="0.25 0.15 0">
        <joint name="fl_hip_joint" type="hinge" axis="1 0 0" range="-0.8 0.8" damping="0.5"/>
        <geom name="fl_hip_geom" type="capsule" size="0.03" fromto="0 0 0 0 0.05 0" 
              rgba="0.5 0.5 0.5 1" mass="0.5"/>
        
        <body name="fl_thigh" pos="0 0.05 0">
          <joint name="fl_thigh_joint" type="hinge" axis="0 1 0" range="-2.8 0.8" damping="0.5"/>
          <geom name="fl_thigh_geom" type="capsule" size="0.03" fromto="0 0 0 0 0 -0.20" 
                rgba="0.3 0.3 0.8 1" mass="1.0"/>
          
          <body name="fl_calf" pos="0 0 -0.20">
            <joint name="fl_calf_joint" type="hinge" axis="0 1 0" range="-0.5 2.8" damping="0.5"/>
            <geom name="fl_calf_geom" type="capsule" size="0.025" fromto="0 0 0 0 0 -0.20" 
                  rgba="0.3 0.3 0.8 1" mass="0.8"/>
            
            <!-- Foot contact -->
            <geom name="fl_foot" type="sphere" size="0.03" pos="0 0 -0.20" 
                  rgba="0.1 0.1 0.1 1" mass="0.2" friction="1.5 0.005 0.0001"/>
          </body>
        </body>
      </body>
      
      <!-- Front Right Leg -->
      <body name="fr_hip" pos="0.25 -0.15 0">
        <joint name="fr_hip_joint" type="hinge" axis="1 0 0" range="-0.8 0.8" damping="0.5"/>
        <geom name="fr_hip_geom" type="capsule" size="0.03" fromto="0 0 0 0 -0.05 0" 
              rgba="0.5 0.5 0.5 1" mass="0.5"/>
        
        <body name="fr_thigh" pos="0 -0.05 0">
          <joint name="fr_thigh_joint" type="hinge" axis="0 1 0" range="-2.8 0.8" damping="0.5"/>
          <geom name="fr_thigh_geom" type="capsule" size="0.03" fromto="0 0 0 0 0 -0.20" 
                rgba="0.3 0.3 0.8 1" mass="1.0"/>
          
          <body name="fr_calf" pos="0 0 -0.20">
            <joint name="fr_calf_joint" type="hinge" axis="0 1 0" range="-0.5 2.8" damping="0.5"/>
            <geom name="fr_calf_geom" type="capsule" size="0.025" fromto="0 0 0 0 0 -0.20" 
                  rgba="0.3 0.3 0.8 1" mass="0.8"/>
            
            <geom name="fr_foot" type="sphere" size="0.03" pos="0 0 -0.20" 
                  rgba="0.1 0.1 0.1 1" mass="0.2" friction="1.5 0.005 0.0001"/>
          </body>
        </body>
      </body>
      
      <!-- Rear Left Leg -->
      <body name="rl_hip" pos="-0.25 0.15 0">
        <joint name="rl_hip_joint" type="hinge" axis="1 0 0" range="-0.8 0.8" damping="0.5"/>
        <geom name="rl_hip_geom" type="capsule" size="0.03" fromto="0 0 0 0 0.05 0" 
              rgba="0.5 0.5 0.5 1" mass="0.5"/>
        
        <body name="rl_thigh" pos="0 0.05 0">
          <joint name="rl_thigh_joint" type="hinge" axis="0 1 0" range="-2.8 0.8" damping="0.5"/>
          <geom name="rl_thigh_geom" type="capsule" size="0.03" fromto="0 0 0 0 0 -0.20" 
                rgba="0.3 0.3 0.8 1" mass="1.0"/>
          
          <body name="rl_calf" pos="0 0 -0.20">
            <joint name="rl_calf_joint" type="hinge" axis="0 1 0" range="-0.5 2.8" damping="0.5"/>
            <geom name="rl_calf_geom" type="capsule" size="0.025" fromto="0 0 0 0 0 -0.20" 
                  rgba="0.3 0.3 0.8 1" mass="0.8"/>
            
            <geom name="rl_foot" type="sphere" size="0.03" pos="0 0 -0.20" 
                  rgba="0.1 0.1 0.1 1" mass="0.2" friction="1.5 0.005 0.0001"/>
          </body>
        </body>
      </body>
      
      <!-- Rear Right Leg -->
      <body name="rr_hip" pos="-0.25 -0.15 0">
        <joint name="rr_hip_joint" type="hinge" axis="1 0 0" range="-0.8 0.8" damping="0.5"/>
        <geom name="rr_hip_geom" type="capsule" size="0.03" fromto="0 0 0 0 -0.05 0" 
              rgba="0.5 0.5 0.5 1" mass="0.5"/>
        
        <body name="rr_thigh" pos="0 -0.05 0">
          <joint name="rr_thigh_joint" type="hinge" axis="0 1 0" range="-2.8 0.8" damping="0.5"/>
          <geom name="rr_thigh_geom" type="capsule" size="0.03" fromto="0 0 0 0 0 -0.20" 
                rgba="0.3 0.3 0.8 1" mass="1.0"/>
          
          <body name="rr_calf" pos="0 0 -0.20">
            <joint name="rr_calf_joint" type="hinge" axis="0 1 0" range="-0.5 2.8" damping="0.5"/>
            <geom name="rr_calf_geom" type="capsule" size="0.025" fromto="0 0 0 0 0 -0.20" 
                  rgba="0.3 0.3 0.8 1" mass="0.8"/>
            
            <geom name="rr_foot" type="sphere" size="0.03" pos="0 0 -0.20" 
                  rgba="0.1 0.1 0.1 1" mass="0.2" friction="1.5 0.005 0.0001"/>
          </body>
        </body>
      </body>
      
    </body>
  </worldbody>
  
  <!-- Actuators: Position control for each joint -->
  <actuator>
    <!-- Front Left -->
    <position name="fl_hip_act" joint="fl_hip_joint" kp="100" kv="10"/>
    <position name="fl_thigh_act" joint="fl_thigh_joint" kp="100" kv="10"/>
    <position name="fl_calf_act" joint="fl_calf_joint" kp="100" kv="10"/>
    
    <!-- Front Right -->
    <position name="fr_hip_act" joint="fr_hip_joint" kp="100" kv="10"/>
    <position name="fr_thigh_act" joint="fr_thigh_joint" kp="100" kv="10"/>
    <position name="fr_calf_act" joint="fr_calf_joint" kp="100" kv="10"/>
    
    <!-- Rear Left -->
    <position name="rl_hip_act" joint="rl_hip_joint" kp="100" kv="10"/>
    <position name="rl_thigh_act" joint="rl_thigh_joint" kp="100" kv="10"/>
    <position name="rl_calf_act" joint="rl_calf_joint" kp="100" kv="10"/>
    
    <!-- Rear Right -->
    <position name="rr_hip_act" joint="rr_hip_joint" kp="100" kv="10"/>
    <position name="rr_thigh_act" joint="rr_thigh_joint" kp="100" kv="10"/>
    <position name="rr_calf_act" joint="rr_calf_joint" kp="100" kv="10"/>
  </actuator>
  
</mujoco>
